# -BIGDATACOVID19
Итоговое задание 
# Аналитическая система мониторинга COVID-19 на основе рентгеновских данных

## Описание проекта
Данный проект посвящён разработке аналитической системы для эпидемиологического мониторинга COVID-19 на основе метаданных рентгеновских снимков грудной клетки.  
В работе используется стек технологий Big Data, включая **PySpark** и **Spark SQL**, что позволяет эффективно обрабатывать и анализировать медицинские данные.

Проект выполнен в рамках учебной дисциплины **«Инфраструктура Big Data»** и направлен на практическое применение методов распределённых вычислений, SQL-аналитики и визуализации данных.

---

## Цель проекта
Разработать аналитическую систему, позволяющую:
- анализировать распространённость диагнозов COVID-19;
- выявлять демографические и временные закономерности;
- оценивать качество медицинских метаданных;
- визуализировать результаты для поддержки эпидемиологического мониторинга.

---

## Используемый датасет
Источник данных: **COVID-19 Chest X-Ray Dataset**  
Файл метаданных: `metadata.csv`

Датасет содержит информацию о пациентах и рентгеновских исследованиях, включая:

| Поле | Описание |
|-----|---------|
| patientid | идентификатор пациента |
| age | возраст пациента |
| sex | пол |
| finding | диагноз |
| view | проекция снимка |
| date | дата исследования |
| clinical_notes | клинические заметки |

---

## Стек технологий
- Python 3  
- PySpark  
- Spark SQL  
- Pandas  
- Matplotlib  
- Seaborn  
- Google Colab  

---

## Архитектура решения
1. Загрузка и парсинг CSV-файла с использованием PySpark  
2. Очистка и предобработка данных  
3. Анализ качества данных  
4. SQL-аналитика в Spark  
5. Визуализация результатов  
6. Сохранение обработанных данных в формате Parquet  


---

## Предобработка данных
В рамках предобработки выполнены следующие шаги:
- обработка пропущенных значений:
  - числовые поля заполнялись медианными значениями;
  - категориальные поля — значением `Unknown`;
- унификация диагнозов (COVID-19, Pneumonia, Other);
- очистка строковых полей от лишних пробелов;
- удаление дубликатов записей;
- нормализация и парсинг дат исследований;
- категоризация возраста пациентов.

---

## Анализ качества данных
Проведён анализ качества датасета:
- построено распределение пропущенных значений по всем признакам;
- выявлены и обработаны потенциальные аномалии возраста;
- зафиксированы проблемы неполноты данных в медицинских метаданных.

После очистки аномальных значений возраста не выявлено.

---

## SQL-аналитика
С использованием Spark SQL реализованы следующие аналитические запросы:

1. **Базовая статистика по диагнозам**  
2. **Распределение пациентов по полу и диагнозам**  
3. **Оконная функция**: топ-3 пациентов по возрасту в каждой группе диагнозов  
4. **Анализ временных трендов** по датам исследований  
5. **Анализ проекций снимков** и их связи с диагнозами  

Для аналитики активно использовались агрегатные функции и оконные функции Spark SQL.

---

## Визуализация данных
В проекте реализованы следующие визуализации:
- круговая диаграмма распределения диагнозов;
- столбчатая диаграмма по возрастным группам;
- линейный график временных трендов исследований;
- heatmap распределения диагнозов по рентгеновским проекциям.

Визуализации построены с использованием Pandas и Matplotlib.

---

## Основные выводы
- Наиболее распространённый диагноз в датасете — COVID-19;
- Среди пациентов преобладают лица старше 50 лет;
- Наблюдается преобладание пациентов мужского пола;
- Наиболее часто используемые проекции снимков — PA и AP;
- Резкий рост количества исследований с COVID-19 наблюдается в начале 2020 года;
- PySpark и Spark SQL показали высокую эффективность для анализа медицинских Big Data.

---

## Структура проекта
project/
├── analysis.ipynb # Jupyter Notebook с полным анализом
├── presentation.pdf # Презентация с результатами проекта
├── README.md # Описание проекта
└── requirements.txt # Зависимости

---

## Запуск проекта
Проект рекомендуется запускать в **Google Colab**.

1. Установить зависимости:
bash
pip install pyspark
Загрузить файл metadata.csv в рабочую директорию

Открыть analysis.ipynb и последовательно выполнить все ячейки

Перспективы развития

подключение анализа изображений (CNN);

расширение анализа на другие заболевания;

автоматизация обновления данных;

интеграция с BI-инструментами.
